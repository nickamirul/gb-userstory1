# Math Calculator - Full Stack Application

A secure, full-stack math calculator application featuring a React frontend and Node.js backend that communicate via HTTPS REST API with API key authentication and SSL/TLS encryption. This project demonstrates modern web development practices, secure API communication, and comprehensive mathematical expression parsing.

## ğŸ“‹ Project Overview

This application fulfills User Story 1 requirements by providing:

- **Frontend**: Modern React web interface for mathematical calculations
- **Backend**: Secure Node.js/Express API server with authentication
- **Communication**: HTTPS REST API calls between client and server
- **Security**: API key authentication for all requests
- **Validation**: Comprehensive input validation and error handling

### Key Features

âœ… **Mathematical Operations**: Addition (+), Subtraction (-), Multiplication (*), Division (/)  
âœ… **Operator Precedence**: *, / have higher precedence over +, -  
âœ… **Parentheses Support**: Override operator precedence with parentheses  
âœ… **API Key Authentication**: Secure endpoint access  
âœ… **Real-time Validation**: Input validation with user-friendly error messages  
âœ… **Calculation History**: Local storage of previous calculations  
âœ… **Responsive Design**: Modern UI with TailwindCSS  
âœ… **Comprehensive Testing**: Extensive positive and negative test cases  

## ğŸ›  Technology Stack

### Frontend
- **Framework**: React 19.1.1
- **Build Tool**: Vite 7.1.2
- **Styling**: TailwindCSS 3.4.17
- **HTTP Client**: Axios 1.11.0
- **Icons**: Lucide React
- **Utilities**: clsx, tailwind-merge

### Backend
- **Runtime**: Node.js (â‰¥14.0.0)
- **Framework**: Express.js 4.18.2
- **Security**: Helmet 7.1.0
- **CORS**: cors 2.8.5
- **Rate Limiting**: express-rate-limit 7.1.5
- **Environment**: dotenv 16.6.1

## ğŸ“ Project Structure

```
gb-userstory1/
â”œâ”€â”€ README.md                 # This file
â”œâ”€â”€ .gitignore               # Git ignore rules (includes *.pem, .env)
â”œâ”€â”€ certs/                   # SSL certificates (local development)
â”‚   â”œâ”€â”€ localhost.pem        # SSL certificate (git-ignored)
â”‚   â””â”€â”€ localhost-key.pem    # Private key (git-ignored)
â”œâ”€â”€ frontend/                # React frontend application
â”‚   â”œâ”€â”€ .env                 # Frontend environment variables (git-ignored)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â””â”€â”€ Calculator.jsx    # Main calculator component
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â””â”€â”€ https.config.js   # HTTPS fallback configuration
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â””â”€â”€ api.js           # API service and utilities
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â””â”€â”€ index.js         # Utility functions
â”‚   â”‚   â”œâ”€â”€ App.jsx              # Main app component
â”‚   â”‚   â”œâ”€â”€ main.jsx             # Application entry point
â”‚   â”‚   â””â”€â”€ index.css            # Global styles
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.js       # Vite configuration with HTTPS setup
â””â”€â”€ backend/                 # Node.js backend server
    â”œâ”€â”€ .env                 # Backend environment variables (git-ignored)
    â”œâ”€â”€ middleware/
    â”‚   â”œâ”€â”€ auth.js          # API key authentication
    â”‚   â”œâ”€â”€ logging.js       # Request logging
    â”‚   â”œâ”€â”€ rateLimit.js     # Rate limiting
    â”‚   â””â”€â”€ validation.js    # Input validation
    â”œâ”€â”€ routes/
    â”‚   â”œâ”€â”€ api.js          # Calculation endpoints
    â”‚   â””â”€â”€ index.js        # Route management
    â”œâ”€â”€ utils/
    â”‚   â””â”€â”€ mathParser.js   # Mathematical expression parser
    â”œâ”€â”€ config.js           # Configuration management
    â”œâ”€â”€ https.config.js     # HTTPS fallback configuration  
    â”œâ”€â”€ server.js           # Main HTTPS server file
    â”œâ”€â”€ test.js             # Comprehensive test suite
    â””â”€â”€ package.json
```

## ğŸš€ Quick Start

### Prerequisites

- Node.js (v14 or higher)
- npm or yarn
- Git

### Installation & Setup

1. **Clone the repository**:
   ```bash
   git clone <repository-url>
   cd gb-userstory1
   ```

2. **Backend Setup**:
   ```bash
   cd backend
   npm install
   npm start
   ```
   The backend server will start on `https://localhost:3001`

3. **Frontend Setup** (in a new terminal):
   ```bash
   cd frontend
   npm install
   npm run dev
   ```
   The frontend will be available at `https://localhost:5173`

## ğŸ”’ HTTPS Setup & SSL Certificates

This application uses **HTTPS for secure local development** with locally-trusted SSL certificates generated by `mkcert`.

### Prerequisites for HTTPS

1. **Install mkcert** (creates locally-trusted development certificates):
   ```bash
   # macOS (using Homebrew)
   brew install mkcert
   
   # Ubuntu/Debian
   sudo apt install libnss3-tools
   wget -O mkcert https://github.com/FiloSottile/mkcert/releases/latest/download/mkcert-v*-linux-amd64
   chmod +x mkcert
   sudo mv mkcert /usr/local/bin/
   
   # Windows (using Chocolatey)
   choco install mkcert
   ```

2. **Install mkcert root CA**:
   ```bash
   mkcert -install
   ```
   This installs the mkcert Certificate Authority in your system's trust store.

### SSL Certificate Generation

1. **Create certificates directory**:
   ```bash
   mkdir -p certs
   ```

2. **Generate SSL certificates**:
   ```bash
   mkcert -key-file certs/localhost-key.pem -cert-file certs/localhost.pem localhost 127.0.0.1 ::1
   ```

This creates:
- `certs/localhost.pem` - SSL certificate file
- `certs/localhost-key.pem` - Private key file (âš ï¸ Keep secure)

### Environment Configuration

Create `.env` files in both frontend and backend directories:

**Backend `.env`** (`backend/.env`):
```env
# Backend Environment Configuration
PORT=3001
NODE_ENV=development
API_KEY=math-calculator-api-key
```

**Frontend `.env`** (`frontend/.env`):
```env
# Frontend Environment Configuration
VITE_API_BASE_URL=https://localhost:3001
VITE_API_KEY=math-calculator-api-key
```

### ğŸ” SSL Certificate Security

- **âœ… Locally-trusted**: No browser security warnings
- **ğŸ”’ Development-only**: These certificates are for local development
- **ğŸ“ Gitignored**: Certificate files are excluded from version control
- **â° Auto-expires**: mkcert certificates expire automatically (typically 2-3 years)
- **ğŸ”„ Regeneratable**: Can be recreated anytime with the same mkcert commands

### Why HTTPS for Local Development?

1. **ğŸ›¡ï¸ Security Best Practice**: Matches production environment
2. **ğŸ”’ Encrypted Communication**: Protects API keys and data in transit
3. **ğŸ“± PWA Compatibility**: Required for Progressive Web App features
4. **ğŸŒ Modern Web APIs**: Many browser APIs require HTTPS
5. **ğŸ¯ Testing Realism**: Tests under production-like conditions

### Available Scripts

#### Backend
- `npm start` - Start production server
- `npm run dev` - Start development server with nodemon
- `npm test` - Run comprehensive test suite

#### Frontend
- `npm run dev` - Start development server
- `npm run build` - Build for production
- `npm run preview` - Preview production build
- `npm run lint` - Run ESLint

## ğŸ” API Authentication

All API requests require authentication via API key in the request headers:

```javascript
Headers: {
  "X-API-Key": "math-calculator-api-key"
  // or alternatively:
  // "Authorization": "math-calculator-api-key"
}
```

## ğŸ“¡ API Endpoints

### Calculate Expression

```https
POST https://localhost:3001/api/v1/calculate
Content-Type: application/json
X-API-Key: math-calculator-api-key

{
  "expression": "2 + 3 * 4"
}
```

#### Success Response
```json
{
  "success": true,
  "expression": "2 + 3 * 4",
  "result": 14,
  "timestamp": "2024-01-01T12:00:00.000Z"
}
```

#### Error Response
```json
{
  "success": false,
  "error": "Division by zero is not allowed",
  "code": "DIVISION_BY_ZERO",
  "expression": "5 / 0"
}
```

## ğŸ§ª Test Cases

### Positive Test Cases âœ…

| Test Case | Expression | Expected Result | Description |
|-----------|------------|-----------------|-------------|
| 1 | `2 + 3` | `5` | Simple addition |
| 2 | `10 - 4` | `6` | Simple subtraction |
| 3 | `3 * 4` | `12` | Simple multiplication |
| 4 | `15 / 3` | `5` | Simple division |
| 5 | `2 + 3 * 4` | `14` | Operator precedence (multiplication first) |
| 6 | `(2 + 3) * 4` | `20` | Parentheses override precedence |
| 7 | `10 / 2 + 3` | `8` | Division before addition |
| 8 | `2.5 + 1.5` | `4` | Decimal numbers |
| 9 | `100 - 50 + 25` | `75` | Multiple operations (left to right) |
| 10 | `2 * 3 + 4 * 5` | `26` | Multiple multiplication operations |

### Negative Test Cases âŒ

| Test Case | Expression | Expected Behavior | Description |
|-----------|------------|-------------------|-------------|
| 1 | `5 / 0` | Error: "Division by zero is not allowed" | Division by zero |
| 2 | `2 +` | Error: "Invalid expression" | Incomplete expression |
| 3 | `+ 3` | Error: "Invalid expression" | Expression starting with operator |
| 4 | `(2 + 3` | Error: "Mismatched parentheses" | Unclosed parenthesis |
| 5 | `2 + 3)` | Error: "Mismatched parentheses" | Extra closing parenthesis |
| 6 | `2 ** 3` | Error: "Invalid character" | Unsupported operator |
| 7 | `2 & 3` | Error: "Invalid character" | Invalid character |
| 8 | `` | Error: "Expression cannot be empty" | Empty expression |
| 9 | `   ` | Error: "Expression cannot be empty" | Whitespace only |
| 10 | `2..5 + 3` | Error: "Invalid character" | Invalid number format |

### API Authentication Test Cases ğŸ”‘

| Test Case | Scenario | Expected Result |
|-----------|----------|-----------------|
| 1 | Valid API key | 200 OK with calculation result |
| 2 | Missing API key | 401 Unauthorized |
| 3 | Invalid API key | 401 Unauthorized |
| 4 | Malformed API key | 401 Unauthorized |

## ğŸƒâ€â™‚ï¸ Running Tests

### Backend Tests
```bash
cd backend
npm test
```

This will run all test cases and display results:
- âœ… Positive test cases (mathematical operations)
- âŒ Negative test cases (error handling)
- ğŸ”‘ API authentication tests

### Manual Frontend Testing
1. Open the calculator at `https://localhost:5173`
2. Try the test expressions listed above
3. Verify error handling for invalid inputs
4. Test the calculation history feature

## ğŸ”§ Configuration

### Environment Variables

Both frontend and backend use `.env` files for configuration:

#### Backend Configuration (`backend/.env`)
```env
# Server Configuration
PORT=3001                           # HTTPS server port
NODE_ENV=development                 # Environment mode (development/production)

# Security
API_KEY=math-calculator-api-key     # API authentication key
```

#### Frontend Configuration (`frontend/.env`)
```env
# API Configuration  
VITE_API_BASE_URL=https://localhost:3001    # Backend HTTPS URL
VITE_API_KEY=math-calculator-api-key        # API authentication key
```

### Configuration Priority

1. **Environment variables** (`.env` files) - **Highest Priority**
2. **Fallback configurations** (`https.config.js` files) - Used if `.env` is missing

### SSL Certificate Configuration

Both frontend and backend automatically use SSL certificates from:
- **Certificate**: `certs/localhost.pem`
- **Private Key**: `certs/localhost-key.pem`

These paths are configured in:
- **Frontend**: `vite.config.js` (Vite HTTPS server)
- **Backend**: `server.js` (Express HTTPS server)

## ğŸ›¡ Security Features

1. **ğŸ”’ HTTPS/TLS Encryption**: End-to-end encryption for all communications
2. **ğŸ”‘ API Key Authentication**: All endpoints protected with API key validation  
3. **ğŸ›¡ï¸ SSL Certificates**: Locally-trusted development certificates via mkcert
4. **âœ… Input Validation**: Comprehensive sanitization and validation of mathematical expressions
5. **â±ï¸ Rate Limiting**: Configurable request rate limiting to prevent abuse
6. **ğŸŒ CORS Configuration**: Controlled cross-origin resource sharing
7. **ğŸ” Security Headers**: Helmet.js provides additional security headers
8. **âŒ Error Handling**: Prevents information leakage through detailed error messages

## ğŸŒŸ Additional Features

### Frontend
- **Real-time Validation**: Input validation with immediate feedback
- **Calculation History**: Stores up to 50 previous calculations in localStorage
- **Copy to Clipboard**: Easy copying of calculation results
- **Responsive Design**: Mobile-first approach with TailwindCSS
- **Accessibility**: ARIA labels, keyboard navigation, screen reader support
- **Loading States**: Visual feedback during API calls
- **Offline Detection**: Shows connection status

### Backend
- **Mathematical Parser**: Custom implementation using Shunting Yard algorithm
- **Comprehensive Logging**: Request logging middleware
- **Error Categories**: Detailed error codes for different failure types
- **Rate Limiting**: Configurable request throttling
- **Health Monitoring**: Server status and connection monitoring

## ğŸ“ˆ Performance Considerations

- **Frontend**: Optimized bundle size with Vite, lazy loading, and efficient React patterns
- **Backend**: Lightweight Express server with minimal dependencies
- **API**: Efficient mathematical parsing with proper error handling
- **Caching**: Browser caching for static assets and calculation history

## ğŸŒ Browser Support

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## ğŸ¤ Contributing

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## ğŸ“„ License

This project is licensed under the MIT License - see the package.json files for details.

## ğŸ‘¨â€ğŸ’» Author

**Amirul Ismail**

---

**Note**: This project demonstrates full-stack development best practices including secure API communication, proper error handling, comprehensive testing, and modern web technologies.